{"ast":null,"code":"var _jsxFileName = \"/Users/theodiamant/Desktop/webrtc/client/src/components/CallPage.js\",\n  _s = $RefreshSig$();\n// src/pages/CallPage.jsx\nimport React, { useState } from \"react\";\nimport useWebRTC from \"../hooks/useWebRTC\";\nimport PrecallSplash from \"../components/PrecallSplash\";\nimport MicIcon from \"@mui/icons-material/Mic\";\nimport MicOffIcon from \"@mui/icons-material/MicOff\";\nimport CallEndIcon from \"@mui/icons-material/CallEnd\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function CallPage({\n  callId\n}) {\n  _s();\n  const [localStream, setLocalStream] = useState(null);\n  const [joined, setJoined] = useState(false);\n  const [muted, setMuted] = useState(false);\n  const {\n    remoteAudioRef,\n    localSpeaking,\n    remoteSpeaking,\n    toggleMute,\n    hangUp\n  } = useWebRTC(callId, {\n    start: joined && !!localStream,\n    isInitiator: true,\n    // ou false selon ton rôle\n    localStream\n  });\n  const handleJoin = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: true\n      });\n      setLocalStream(stream);\n      setMuted(false);\n      setJoined(true);\n    } catch (err) {\n      console.error(\"Micro non autorisé :\", err);\n      alert(\"Vous devez autoriser le micro pour rejoindre.\");\n    }\n  };\n  if (!joined) return /*#__PURE__*/_jsxDEV(PrecallSplash, {\n    onReady: handleJoin\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"call-app\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"participants\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        children: [localSpeaking && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wave\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pic-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/images/icon.png\",\n            alt: \"Vous\",\n            className: \"avatar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 47,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        children: [remoteSpeaking && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wave\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 30\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pic-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/images/icon.png\",\n            alt: \"Interlocuteur\",\n            className: \"avatar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"control-btn\",\n        onClick: () => {\n          toggleMute();\n          setMuted(m => !m);\n        },\n        children: muted ? /*#__PURE__*/_jsxDEV(MicOffIcon, {\n          fontSize: \"large\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 20\n        }, this) : /*#__PURE__*/_jsxDEV(MicIcon, {\n          fontSize: \"large\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 54\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"control-btn end-btn\",\n        onClick: hangUp,\n        children: /*#__PURE__*/_jsxDEV(CallEndIcon, {\n          fontSize: \"large\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: remoteAudioRef,\n      autoPlay: true,\n      hidden: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 5\n  }, this);\n}\n_s(CallPage, \"1ZAelvGwuBb7tJrX0kfnG/ixpLo=\", false, function () {\n  return [useWebRTC];\n});\n_c = CallPage;\nvar _c;\n$RefreshReg$(_c, \"CallPage\");","map":{"version":3,"names":["React","useState","useWebRTC","PrecallSplash","MicIcon","MicOffIcon","CallEndIcon","jsxDEV","_jsxDEV","CallPage","callId","_s","localStream","setLocalStream","joined","setJoined","muted","setMuted","remoteAudioRef","localSpeaking","remoteSpeaking","toggleMute","hangUp","start","isInitiator","handleJoin","stream","navigator","mediaDevices","getUserMedia","audio","err","console","error","alert","onReady","fileName","_jsxFileName","lineNumber","columnNumber","className","children","src","alt","onClick","m","fontSize","ref","autoPlay","hidden","_c","$RefreshReg$"],"sources":["/Users/theodiamant/Desktop/webrtc/client/src/components/CallPage.js"],"sourcesContent":["// src/pages/CallPage.jsx\nimport React, { useState } from \"react\";\nimport useWebRTC from \"../hooks/useWebRTC\";\nimport PrecallSplash from \"../components/PrecallSplash\";\nimport MicIcon from \"@mui/icons-material/Mic\";\nimport MicOffIcon from \"@mui/icons-material/MicOff\";\nimport CallEndIcon from \"@mui/icons-material/CallEnd\";\n\nexport default function CallPage({ callId }) {\n  const [localStream, setLocalStream] = useState(null);\n  const [joined, setJoined] = useState(false);\n  const [muted, setMuted] = useState(false);\n\n  const {\n    remoteAudioRef,\n    localSpeaking,\n    remoteSpeaking,\n    toggleMute,\n    hangUp,\n  } = useWebRTC(callId, {\n    start: joined && !!localStream,\n    isInitiator: true, // ou false selon ton rôle\n    localStream,\n  });\n\n  const handleJoin = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      setLocalStream(stream);\n      setMuted(false);\n      setJoined(true);\n    } catch (err) {\n      console.error(\"Micro non autorisé :\", err);\n      alert(\"Vous devez autoriser le micro pour rejoindre.\");\n    }\n  };\n\n  if (!joined) return <PrecallSplash onReady={handleJoin} />;\n\n  return (\n    <div className=\"call-app\">\n      <div className=\"participants\">\n        {/* Carte “Vous” */}\n        <div className=\"card\">\n          {localSpeaking && <div className=\"wave\" />}\n          <div className=\"pic-wrapper\">\n            <img src=\"/images/icon.png\" alt=\"Vous\" className=\"avatar\" />\n          </div>\n        </div>\n        {/* Carte “Interlocuteur” */}\n        <div className=\"card\">\n          {remoteSpeaking && <div className=\"wave\" />}\n          <div className=\"pic-wrapper\">\n            <img src=\"/images/icon.png\" alt=\"Interlocuteur\" className=\"avatar\" />\n          </div>\n        </div>\n      </div>\n\n      <div className=\"controls\">\n        <button\n          className=\"control-btn\"\n          onClick={() => {\n            toggleMute();\n            setMuted((m) => !m);\n          }}\n        >\n          {muted ? <MicOffIcon fontSize=\"large\" /> : <MicIcon fontSize=\"large\" />}\n        </button>\n        <button className=\"control-btn end-btn\" onClick={hangUp}>\n          <CallEndIcon fontSize=\"large\" />\n        </button>\n      </div>\n\n      {/* audio distant en background */}\n      <audio ref={remoteAudioRef} autoPlay hidden />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}