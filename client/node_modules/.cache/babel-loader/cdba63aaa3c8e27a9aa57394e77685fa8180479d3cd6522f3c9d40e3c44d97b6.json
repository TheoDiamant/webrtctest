{"ast":null,"code":"var _jsxFileName = \"/Users/theodiamant/Desktop/webrtc/client/src/components/CallPage.js\",\n  _s = $RefreshSig$();\n// File: src/components/CallPage.jsx\nimport React, { useState, useEffect, useRef } from \"react\";\nimport useWebRTC from \"../hooks/useWebRTC\";\nimport Chat from \"./Chat\";\nimport PrecallSplash from \"./PrecallSplash\";\nimport { Mic, MicOff, PhoneOff, MessageSquare } from \"lucide-react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function CallPage({\n  callId\n}) {\n  _s();\n  const params = new URLSearchParams(window.location.search);\n  const isInitiator = params.get(\"initiator\") === \"true\";\n  const [splashDone, setSplashDone] = useState(isInitiator);\n  const [chatOpen, setChatOpen] = useState(false);\n  const {\n    status,\n    remoteStream,\n    chatMessages,\n    sendMessage,\n    isChannelOpen,\n    hangUp\n  } = useWebRTC(callId, {\n    start: splashDone,\n    isInitiator\n  });\n  const localAudioRef = useRef();\n  const remoteAudioRef = useRef();\n  useEffect(() => {\n    if (remoteStream && remoteAudioRef.current) remoteAudioRef.current.srcObject = remoteStream;\n  }, [remoteStream]);\n  const [message, setMessage] = useState(\"\");\n  const handleSend = () => {\n    sendMessage(message);\n    setMessage(\"\");\n  };\n  if (!splashDone) return /*#__PURE__*/_jsxDEV(PrecallSplash, {\n    onReady: () => setSplashDone(true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 37,\n    columnNumber: 27\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"call-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"Call ID: \", callId]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setChatOpen(o => !o),\n        children: /*#__PURE__*/_jsxDEV(MessageSquare, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"participant local\",\n        children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n          ref: localAudioRef,\n          autoPlay: true,\n          muted: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"You\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"participant remote\",\n        children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n          ref: remoteAudioRef,\n          autoPlay: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Peer\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 9\n      }, this), chatOpen && /*#__PURE__*/_jsxDEV(Chat, {\n        messages: chatMessages,\n        message: message,\n        setMessage: setMessage,\n        onSend: handleSend\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: hangUp,\n        children: /*#__PURE__*/_jsxDEV(PhoneOff, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"status\",\n      children: [\"Status: \", status]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 5\n  }, this);\n}\n_s(CallPage, \"VvL1xMyV7XCirjg81HebbLzqyDM=\", false, function () {\n  return [useWebRTC];\n});\n_c = CallPage;\nvar _c;\n$RefreshReg$(_c, \"CallPage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useWebRTC","Chat","PrecallSplash","Mic","MicOff","PhoneOff","MessageSquare","jsxDEV","_jsxDEV","CallPage","callId","_s","params","URLSearchParams","window","location","search","isInitiator","get","splashDone","setSplashDone","chatOpen","setChatOpen","status","remoteStream","chatMessages","sendMessage","isChannelOpen","hangUp","start","localAudioRef","remoteAudioRef","current","srcObject","message","setMessage","handleSend","onReady","fileName","_jsxFileName","lineNumber","columnNumber","className","children","onClick","o","ref","autoPlay","muted","messages","onSend","_c","$RefreshReg$"],"sources":["/Users/theodiamant/Desktop/webrtc/client/src/components/CallPage.js"],"sourcesContent":["// File: src/components/CallPage.jsx\nimport React, { useState, useEffect, useRef } from \"react\";\nimport useWebRTC from \"../hooks/useWebRTC\";\nimport Chat from \"./Chat\";\nimport PrecallSplash from \"./PrecallSplash\";\nimport { Mic, MicOff, PhoneOff, MessageSquare } from \"lucide-react\";\n\nexport default function CallPage({ callId }) {\n  const params = new URLSearchParams(window.location.search);\n  const isInitiator = params.get(\"initiator\") === \"true\";\n  const [splashDone, setSplashDone] = useState(isInitiator);\n  const [chatOpen, setChatOpen] = useState(false);\n\n  const {\n    status,\n    remoteStream,\n    chatMessages,\n    sendMessage,\n    isChannelOpen,\n    hangUp,\n  } = useWebRTC(callId, { start: splashDone, isInitiator });\n\n  const localAudioRef = useRef();\n  const remoteAudioRef = useRef();\n\n  useEffect(() => {\n    if (remoteStream && remoteAudioRef.current)\n      remoteAudioRef.current.srcObject = remoteStream;\n  }, [remoteStream]);\n\n  const [message, setMessage] = useState(\"\");\n  const handleSend = () => {\n    sendMessage(message);\n    setMessage(\"\");\n  };\n\n  if (!splashDone) return <PrecallSplash onReady={() => setSplashDone(true)} />;\n\n  return (\n    <div className=\"call-container\">\n      <header>\n        <span>Call ID: {callId}</span>\n        <button onClick={() => setChatOpen((o) => !o)}>\n          <MessageSquare />\n        </button>\n      </header>\n      <main>\n        <div className=\"participant local\">\n          <audio ref={localAudioRef} autoPlay muted />\n          <p>You</p>\n        </div>\n        <div className=\"participant remote\">\n          <audio ref={remoteAudioRef} autoPlay />\n          <p>Peer</p>\n        </div>\n        {chatOpen && (\n          <Chat\n            messages={chatMessages}\n            message={message}\n            setMessage={setMessage}\n            onSend={handleSend}\n          />\n        )}\n      </main>\n      <footer>\n        <button onClick={hangUp}>\n          <PhoneOff />\n        </button>\n      </footer>\n      <div className=\"status\">Status: {status}</div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}