{"ast":null,"code":"var _jsxFileName = \"/Users/theodiamant/Desktop/webrtc/client/src/components/CallPage.js\",\n  _s = $RefreshSig$();\n// src/pages/CallPage.jsx\nimport React, { useState } from \"react\";\nimport useWebRTC from \"../hooks/useWebRTC\";\nimport PrecallSplash from \"../components/PrecallSplash\";\nimport MicIcon from \"@mui/icons-material/Mic\";\nimport MicOffIcon from \"@mui/icons-material/MicOff\";\nimport CallEndIcon from \"@mui/icons-material/CallEnd\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function CallPage({\n  callId\n}) {\n  _s();\n  const [localStream, setLocalStream] = useState(null);\n  const [joined, setJoined] = useState(false);\n  const [muted, setMuted] = useState(false);\n  const {\n    remoteAudioRef,\n    toggleMute,\n    hangUp,\n    localSpeaking,\n    remoteSpeaking\n  } = useWebRTC(callId, {\n    start: joined && !!localStream,\n    isInitiator: true,\n    // adapte selon ton rôle\n    localStream\n  });\n  const handleJoin = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: true\n      });\n      setLocalStream(stream);\n      setMuted(false);\n      setJoined(true);\n    } catch {\n      alert(\"Vous devez autoriser le micro pour rejoindre.\");\n    }\n  };\n  if (!joined) return /*#__PURE__*/_jsxDEV(PrecallSplash, {\n    onReady: handleJoin\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 32,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"call-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"participants\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"participant-card\",\n        children: [localSpeaking && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wave\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/images/icon.png\",\n          alt: \"Vous\",\n          className: \"avatar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"participant-card\",\n        children: [remoteSpeaking && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wave\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 30\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/images/icon.png\",\n          alt: \"Interlocuteur\",\n          className: \"avatar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"control-btn\",\n        onClick: () => {\n          toggleMute();\n          setMuted(m => !m);\n        },\n        children: muted ? /*#__PURE__*/_jsxDEV(MicOffIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 20\n        }, this) : /*#__PURE__*/_jsxDEV(MicIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 37\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"control-btn end-btn\",\n        onClick: hangUp,\n        children: /*#__PURE__*/_jsxDEV(CallEndIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: remoteAudioRef,\n      autoPlay: true,\n      style: {\n        display: \"none\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 5\n  }, this);\n}\n_s(CallPage, \"/y/gkcsZqifyTiTmAFAJ8YsF1eQ=\", false, function () {\n  return [useWebRTC];\n});\n_c = CallPage;\nvar _c;\n$RefreshReg$(_c, \"CallPage\");","map":{"version":3,"names":["React","useState","useWebRTC","PrecallSplash","MicIcon","MicOffIcon","CallEndIcon","jsxDEV","_jsxDEV","CallPage","callId","_s","localStream","setLocalStream","joined","setJoined","muted","setMuted","remoteAudioRef","toggleMute","hangUp","localSpeaking","remoteSpeaking","start","isInitiator","handleJoin","stream","navigator","mediaDevices","getUserMedia","audio","alert","onReady","fileName","_jsxFileName","lineNumber","columnNumber","className","children","src","alt","onClick","m","ref","autoPlay","style","display","_c","$RefreshReg$"],"sources":["/Users/theodiamant/Desktop/webrtc/client/src/components/CallPage.js"],"sourcesContent":["// src/pages/CallPage.jsx\nimport React, { useState } from \"react\";\nimport useWebRTC from \"../hooks/useWebRTC\";\nimport PrecallSplash from \"../components/PrecallSplash\";\nimport MicIcon from \"@mui/icons-material/Mic\";\nimport MicOffIcon from \"@mui/icons-material/MicOff\";\nimport CallEndIcon from \"@mui/icons-material/CallEnd\";\n\nexport default function CallPage({ callId }) {\n  const [localStream, setLocalStream] = useState(null);\n  const [joined, setJoined] = useState(false);\n  const [muted, setMuted] = useState(false);\n\n  const { remoteAudioRef, toggleMute, hangUp, localSpeaking, remoteSpeaking } =\n    useWebRTC(callId, {\n      start: joined && !!localStream,\n      isInitiator: true, // adapte selon ton rôle\n      localStream,\n    });\n\n  const handleJoin = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      setLocalStream(stream);\n      setMuted(false);\n      setJoined(true);\n    } catch {\n      alert(\"Vous devez autoriser le micro pour rejoindre.\");\n    }\n  };\n\n  if (!joined) return <PrecallSplash onReady={handleJoin} />;\n\n  return (\n    <div className=\"call-page\">\n      <div className=\"participants\">\n        <div className=\"participant-card\">\n          {localSpeaking && <div className=\"wave\" />}\n          <img src=\"/images/icon.png\" alt=\"Vous\" className=\"avatar\" />\n        </div>\n        <div className=\"participant-card\">\n          {remoteSpeaking && <div className=\"wave\" />}\n          <img src=\"/images/icon.png\" alt=\"Interlocuteur\" className=\"avatar\" />\n        </div>\n      </div>\n\n      <div className=\"controls\">\n        <button\n          className=\"control-btn\"\n          onClick={() => {\n            toggleMute();\n            setMuted((m) => !m);\n          }}\n        >\n          {muted ? <MicOffIcon /> : <MicIcon />}\n        </button>\n        <button className=\"control-btn end-btn\" onClick={hangUp}>\n          <CallEndIcon />\n        </button>\n      </div>\n\n      <audio ref={remoteAudioRef} autoPlay style={{ display: \"none\" }} />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}